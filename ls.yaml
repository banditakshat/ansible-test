---
- name: "Playing with Ansible and Git"
  hosts: localhost
  connection: local
  tasks:
    - name: "Execute a command"
      shell: |
        {{ verbs = ['get', 'list', 'watch', 'create', 'update', 'patch', 'delete', 'deletecollection'] }}
        {{ resources = ['pods', 'services', 'replicationcontrollers', 'deployments', 'configmaps', 'secrets', 'statefulsets', 'daemonsets', 'jobs', 'cronjobs', 'persistentvolumes', 'persistentvolumeclaims', 'ingresses', 'namespaces', 'nodes', 'limitranges', 'resourcequotas', 'endpoints', 'horizontalpodautoscalers', 'certificates'] }}
        {% for verb in verbs %}
        {% for resource in resources %}
        echo "kubectl auth can-i {{ verb }} {{ resource }}"
        {% endfor %}
        {% endfor %}
      register: "output"
    - debug: var=output.stdout_lines
